package com.leetcode.code_04.p_76_minWindow;

class Solution {
    public String minWindow(String s, String t) {
        // 处理边界情况
        if (s == null || t == null || s.length() == 0 || t.length() == 0 || s.length() < t.length()) {
            return "";
        }

        // 记录t中每个字符的出现次数
        int[] tFreq = new int[128];
        for (char c : t.toCharArray()) {
            tFreq[c]++;
        }

        // 记录当前窗口中每个字符的出现次数
        int[] windowFreq = new int[128];

        // 窗口的左右指针
        int left = 0, right = 0;

        // 记录满足条件的字符数
        int matched = 0;
        // t中不同字符的数量
        int required = 0;
        for (int freq : tFreq) {
            if (freq > 0) {
                required++;
            }
        }

        // 记录最小窗口的起始位置和长度
        int minStart = -1;
        int minLen = Integer.MAX_VALUE;

        while (right < s.length()) {
            // 扩大窗口
            char rightChar = s.charAt(right);
            windowFreq[rightChar]++;

            // 检查当前字符是否在t中，且数量是否匹配
            if (tFreq[rightChar] > 0 && windowFreq[rightChar] == tFreq[rightChar]) {
                matched++;
            }

            // 当窗口包含t中所有字符，尝试缩小窗口
            while (left <= right && matched == required) {
                // 更新最小窗口
                if (right - left + 1 < minLen) {
                    minLen = right - left + 1;
                    minStart = left;
                }

                // 缩小窗口
                char leftChar = s.charAt(left);
                windowFreq[leftChar]--;

                // 如果移除的字符导致窗口不再满足条件，减少匹配计数
                if (tFreq[leftChar] > 0 && windowFreq[leftChar] < tFreq[leftChar]) {
                    matched--;
                }

                left++;
            }

            right++;
        }

        return minStart == -1 ? "" : s.substring(minStart, minStart + minLen);
    }
    // 测试代码
    public static void main(String[] args) {
        Solution solution = new Solution();

        // 测试用例1
        String s1 = "ADOBECODEBANC";
        String t1 = "ABC";
        System.out.println("输入: s = \"" + s1 + "\", t = \"" + t1 + "\"");
        System.out.println("输出: \"" + solution.minWindow(s1, t1) + "\"");

        // 测试用例2
        String s2 = "a";
        String t2 = "a";
        System.out.println("\n输入: s = \"" + s2 + "\", t = \"" + t2 + "\"");
        System.out.println("输出: \"" + solution.minWindow(s2, t2) + "\"");

        // 测试用例3
        String s3 = "a";
        String t3 = "aa";
        System.out.println("\n输入: s = \"" + s3 + "\", t = \"" + t3 + "\"");
        System.out.println("输出: \"" + solution.minWindow(s3, t3) + "\"");
    }
}
